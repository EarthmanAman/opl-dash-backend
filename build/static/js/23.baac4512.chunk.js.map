{"version":3,"sources":["components/depot/charts/depot_product_series.js","components/utils/_funcs.js"],"names":["mapData","data","currency_type","values","i","length","push","timestamp","truncate","sum","DepotProductSeriesChart","props","state","spinner","series","selection_dates","options","chart","id","type","height","zoom","autoScaleYaxis","title","text","dashboard_metric","annotations","xaxis","x","Date","startDate","getTime","borderColor","yAxisIndex","dataLabels","enabled","markers","size","style","tickAmount","yaxis","min","tooltip","format","y","formatter","val","selection","ApexCharts","exec","this","endDate","e","position","React","Component","getDerivedStateFromProps","depot_product_series","update_product_series","update_depot_series","revenue","quantity","prod","d","concat","name","currency_type_display","addMonths","date","months","setMonth","getMonth","num","parseFloat","toString","match"],"mappings":"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","file":"static/js/23.baac4512.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nimport ReactApexChart from 'react-apexcharts'\r\nimport ApexCharts from 'apexcharts';\r\nimport { currency_type_display, truncate } from \"../../utils/_funcs\"\r\nimport SpinnerComponent from '../../utils/spinner';\r\n\r\nconst mapData = (data, currency_type) => {\r\n\r\n    let values = []\r\n    for (let i = 0; i < data.length; i++) {\r\n\r\n        values.push([data[i].timestamp, currency_type === \"Million\" ? truncate(data[i].sum / 1000000) : truncate(data[i].sum / 1000)])\r\n    }\r\n\r\n    return values\r\n}\r\n\r\nclass DepotProductSeriesChart extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            spinner: false,\r\n            series: [],\r\n            currency_type: this.props.currency_type,\r\n            selection_dates: this.props.selection_dates,\r\n            options: {\r\n                chart: {\r\n                    id: 'area-datetime',\r\n                    type: 'area',\r\n                    height: 400,\r\n                    zoom: {\r\n                        autoScaleYaxis: false\r\n                    }\r\n                },\r\n                title: {\r\n                    text: this.props.dashboard_metric ? \"Revenue\" : \"Quantities\"\r\n                },\r\n                annotations: {\r\n\r\n                    xaxis: [{\r\n                        x: new Date(`${this.props.selection_dates.startDate}`).getTime(),\r\n                        borderColor: '#999',\r\n                        yAxisIndex: 0,\r\n\r\n                    }]\r\n                },\r\n                dataLabels: {\r\n                    enabled: true\r\n                },\r\n                markers: {\r\n                    size: 0,\r\n                    style: 'hollow',\r\n                },\r\n                xaxis: {\r\n                    type: 'datetime',\r\n                    // min: new Date(`${this.props.selection_dates.startDate}`).getTime(),\r\n                    // max: new Date(`${this.props.selection_dates.endDate}`).getTime(),\r\n                    tickAmount: 5,\r\n                },\r\n                yaxis: {\r\n                    title: {\r\n                        text: 'Kshs (Millions)'\r\n                    },\r\n                    min: 0,\r\n                },\r\n                tooltip: {\r\n                    x: {\r\n                        format: 'dd MMM yyyy'\r\n                    },\r\n                    y: {\r\n                        formatter: this.props.dashboard_metric ? function (val) {\r\n                            return `Kshs ${val} Millions`\r\n                        } : function (val) {\r\n                            return `${val} Litres`\r\n                        }\r\n                    }\r\n                },\r\n                // fill: {\r\n                //   type: 'gradient',\r\n                //   gradient: {\r\n                //     shadeIntensity: 1,\r\n                //     opacityFrom: 0.7,\r\n                //     opacityTo: 0.9,\r\n                //     stops: [0, 100]\r\n                //   }\r\n                // },\r\n            },\r\n\r\n\r\n            selection: 'one_month',\r\n\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps = (props, state) => {\r\n        const { depot_product_series, update_product_series, selection_dates, currency_type, dashboard_metric, update_depot_series } = props\r\n        if (update_depot_series || update_product_series) {\r\n            state.spinner = true\r\n            return state\r\n        } else {\r\n            state.spinner = false\r\n        }\r\n        let data = depot_product_series\r\n\r\n        data = dashboard_metric ? data.revenue : data.quantity\r\n        if (typeof (selection_dates.startDate) === \"string\") {\r\n            selection_dates.startDate = new Date(`${selection_dates.startDate}`)\r\n            selection_dates.endDate = new Date(`${selection_dates.endDate}`)\r\n        }\r\n        let series = []\r\n\r\n        for (let i = 0; i < data.length; i++) {\r\n            let prod = data[i].data\r\n            let d = mapData(prod, currency_type)\r\n\r\n            series = series.concat({\r\n                name: data[i].name,\r\n                data: d\r\n            })\r\n        }\r\n        state.series = series\r\n        state.options.title.text = dashboard_metric ? \"Revenue\" : \"Quantities\"\r\n        // state.options.xaxis.min = selection_dates.startDate.getTime()\r\n        // state.options.xaxis.max = selection_dates.endDate.getTime()\r\n        state.options.yaxis.title.text = dashboard_metric ? `Kshs (${currency_type})` : `Litres (${currency_type})`\r\n        state.options.tooltip.y.formatter = dashboard_metric ? function (val) {\r\n            return `Kshs ${val}${currency_type_display(currency_type)}`\r\n        } : function (val) {\r\n            return `${val}${currency_type_display(currency_type)} Litres`\r\n        }\r\n        state.selection_dates = selection_dates\r\n        state.currency_type = currency_type\r\n        return state\r\n    }\r\n\r\n    render() {\r\n        try {\r\n\r\n            ApexCharts.exec(\r\n                'area-datetime',\r\n                'zoomX',\r\n                new Date(`${this.state.selection_dates.startDate}`).getTime(),\r\n                new Date(`${this.state.selection_dates.endDate}`).getTime(),\r\n\r\n            )\r\n        } catch (e) {\r\n            \"in error\"\r\n        }\r\n        return (\r\n            <div id=\"chart\" >\r\n\r\n                {this.state.spinner ? <div style={{ height: 400, position: \"relative\" }}><SpinnerComponent spinner={this.state.spinner} /></div> :\r\n                    <div id=\"chart-timeline\">\r\n                        <ReactApexChart options={this.state.options} series={this.state.series} type=\"area\" height={400} />\r\n                    </div>\r\n                }\r\n            </div>\r\n\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default DepotProductSeriesChart","export const addMonths = (date, months) => {\r\n    date.setMonth(date.getMonth() + months);\r\n    return date;\r\n}\r\n\r\nexport const currency_type_display = (currency_type) => {\r\n    if (currency_type === \"Million\") {\r\n        return \"m\"\r\n    }\r\n    else {\r\n        return \"k\"\r\n    }\r\n}\r\n\r\nexport const truncate = (num) => {\r\n    return parseFloat(num.toString().match(/^-?\\d+(?:\\.\\d{0,2})?/)[0])\r\n}"],"sourceRoot":""}