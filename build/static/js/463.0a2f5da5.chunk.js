"use strict";(self.webpackChunkopl_frontend=self.webpackChunkopl_frontend||[]).push([[463],{4794:function(e,t,s){var n=s(5861),r=s(5671),a=s(3144),l=s(136),i=s(5716),o=s(7757),c=s.n(o),d=s(2791),u=s(3360),h=s(6168),p=s(4650),_=s(6856),m=s(7161),x=s(7467),f=s(184),j=function(e){(0,l.Z)(s,e);var t=(0,i.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={startDate:new Date(e.props.sales_date.start_date),endDate:new Date(e.props.sales_date.end_date),key:"selection",date:!0,cost:!1},e.handleSelect=function(){var t=(0,n.Z)(c().mark((function t(s){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({startDate:s.selection.startDate,endDate:s.selection.endDate}),n={start_date:s.selection.startDate,end_date:s.selection.endDate},t.next=4,e.props.UPDATE_SALES_DATE_ACTION(n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,a.Z)(s,[{key:"render",value:function(){var e=this.state.startDate,t=this.state.endDate;return(0,f.jsx)("div",{children:(0,f.jsx)("div",{className:"sales-top",children:(0,f.jsx)(x.Z,{trigger:(0,f.jsx)(u.Z,{className:"input-dates",size:"sm",children:(0,f.jsxs)("div",{className:"input-display",children:[(0,f.jsx)("span",{children:(0,f.jsx)(_.kVv,{color:"#D04D30",size:18})}),e.toDateString()," - ",t.toDateString(),(0,f.jsx)("span",{children:(0,f.jsx)(_.Ix0,{size:18})})]})}),position:"bottom",children:(0,f.jsx)(m.Dw,{onChange:this.handleSelect,showSelectionPreview:!0,moveRangeOnFirstSelection:!1,months:2,ranges:[this.state],direction:"horizontal",preventSnapRefocus:!0,calendarFocus:"backwards",className:"date-range"})})})})}}]),s}(d.Component);j.getDerivedStateFromProps=function(e,t){return t.startDate=new Date(e.sales_date.start_date),t.endDate=new Date(e.sales_date.end_date),t};var v={UPDATE_SALES_DATE_ACTION:p.JX};t.Z=(0,h.$j)((function(e){var t={start_date:new Date(2022,3,20),end_date:new Date(2022,3,30)};return{sales_date:e.update_reducer.sales_date?e.update_reducer.sales_date:t,depots:e.list_reducer.depot_list}}),v)(j)},8665:function(e,t,s){var n=s(5861),r=s(5671),a=s(3144),l=s(136),i=s(5716),o=s(7757),c=s.n(o),d=s(2791),u=(s(7467),s(8116)),h=s(717),p=s(4292),_=s(3360),m=s(2591),x=s(6168),f=s(4650),j=s(9600),v=s(184),y=function(e){(0,l.Z)(s,e);var t=(0,i.Z)(s);function s(){var e;(0,r.Z)(this,s);for(var a=arguments.length,l=new Array(a),i=0;i<a;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={sales_list:void 0!==e.props.sales_list?e.props.sales_list:[],sales_date:e.props.sales_date,depot:"All",product:"All",order_no:null,active:1,spinner:!1,success:!0,delete_order:null},e.onSearchChange=function(t){var s=e.state.active,n=50*(s-1),r=50*s;""===t||void 0===t||null===t?e.setState({sales_list:e.props.sales_list.slice(n,r)}):e.setState({order_no:t})},e.onSearch=function(t){t.preventDefault();var s=e.state.order_no,n=e.props.sales_list;n=n.filter((function(e){return e.order_no.includes(s)})),e.setState({sales_list:n,product:"All",depot:"All"})},e.handleCalc=function(){for(var t=e.state.sales_list,s=0,n=0,r=0;r<t.length;r++){var a=t[r];s+=a.vol_obs,n+=a.vol_obs*a.selling_price}return[n,s]},e.handleProductChange=function(){var t=(0,n.Z)(c().mark((function t(s){var n,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props.sales_list,"All"!==s&&(n=n.filter((function(e){return e.product.name===s}))),"All"!==e.state.depot&&(r=e.props.depots[parseInt(e.state.depot)].name,n=n.filter((function(e){return e.depot.name===r}))),e.setState({sales_list:n,product:s});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleDepotChange=function(t){var s=e.props.sales_list;if("All"!==t){var n=e.props.depots[parseInt(t)].name;s=s.filter((function(e){return e.depot.name===n}))}var r=e.state.product;console.log(r),"All"!==r&&(s=s.filter((function(e){return e.product.name===r}))),e.setState({sales_list:s,depot:t})},e}return(0,a.Z)(s,[{key:"numberWithCommas",value:function(e){try{return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}catch(t){return e}}},{key:"render",value:function(){for(var e=this,t=[],s=this.state.active,n=50*(s-1),r=50*s,a=function(n){t.push((0,v.jsx)(u.Z.Item,{active:n===s,onClick:function(){return e.setState({active:n})},children:n},n))},l=1;l<=Math.ceil(this.state.sales_list.length/50);l++)a(l);var i=this.props,o=i.depots,c=i.products,d=this.handleCalc();return(0,v.jsx)("div",{children:this.state.spinner?(0,v.jsx)(j.Z,{spinner:this.state.spinner}):(0,v.jsxs)("div",{className:"sale-table",children:[(0,v.jsx)("div",{className:"sale-table__header",children:(0,v.jsxs)(h.Z,{className:"d-flex",style:{alignItems:"flex-end"},onSubmit:this.onSearch,children:[(0,v.jsxs)(h.Z.Group,{className:"mb-4 pie-select__child sale-table__select",controlId:"exampleForm.ControlInput1",style:{marginBottom:0},children:[(0,v.jsx)(h.Z.Label,{children:"Depot"}),(0,v.jsxs)(h.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleDepotChange(t.target.value)},children:["All"===this.state.depot?null:(0,v.jsx)("option",{value:this.state.depot,children:o[parseInt(this.state.depot)].name}),(0,v.jsx)("option",{value:"All",children:"All"}),o.map((function(t,s){return e.state.depot===s?null:(0,v.jsx)("option",{value:s,children:t.name},s)}))]})]}),(0,v.jsxs)(h.Z.Group,{className:"mb-4 pie-select__child sale-table__select",controlId:"exampleForm.ControlInput1",style:{marginBottom:0},children:[(0,v.jsx)(h.Z.Label,{children:"Product"}),(0,v.jsxs)(h.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleProductChange(t.target.value)},children:["All"===this.state.product?null:(0,v.jsx)("option",{value:this.state.product,children:this.state.product}),(0,v.jsx)("option",{value:"All",children:"All"}),c.map((function(t,s){return e.state.product===t.name?null:(0,v.jsx)("option",{value:t.name,children:t.name},s)}))]})]}),(0,v.jsx)(p.Z,{type:"search",placeholder:"Search by order no.",className:"me-2 sales-table__search-input","aria-label":"Search by order no.",size:"sm",onChange:function(t){return e.onSearchChange(t.target.value)}}),(0,v.jsx)(_.Z,{variant:"outline-primary",type:"submit",children:"Search"})]})}),(0,v.jsxs)(m.Z,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{}),(0,v.jsx)("th",{children:"Date"}),this.props.from_customer?null:(0,v.jsx)("th",{children:"Depot"}),(0,v.jsx)("th",{children:"Product"}),this.props.from_customer?null:(0,v.jsx)("th",{children:"Customer"}),(0,v.jsx)("th",{children:"Order No"}),(0,v.jsx)("th",{children:"Lpo No"}),(0,v.jsx)("th",{children:"Entry No"}),(0,v.jsx)("th",{children:"S.Price"}),(0,v.jsx)("th",{children:"OBS Vol"}),(0,v.jsx)("th",{children:"Vol@20"}),(0,v.jsx)("th",{children:"Amount"}),(0,v.jsx)("th",{children:"Paid"})]})}),(0,v.jsxs)("tbody",{children:[this.state.sales_list.slice(n,r).map((function(t,s){return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:n+s+1}),(0,v.jsx)("td",{children:t.date}),e.props.from_customer?null:(0,v.jsx)("td",{children:t.depot.name}),(0,v.jsx)("td",{children:t.product.name}),e.props.from_customer?null:(0,v.jsx)("td",{children:t.customer.name}),(0,v.jsx)("td",{children:t.order_no}),(0,v.jsx)("td",{children:t.lpo_no}),(0,v.jsx)("td",{children:t.entry_no}),(0,v.jsx)("td",{children:t.selling_price}),(0,v.jsx)("td",{children:e.numberWithCommas(t.vol_obs)}),(0,v.jsx)("td",{children:e.numberWithCommas(t.vol_20)}),(0,v.jsx)("td",{children:e.numberWithCommas(t.vol_obs*t.selling_price)}),(0,v.jsx)("td",{children:t.is_paid?"True":"False"})]},s)})),(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{}),(0,v.jsx)("th",{children:"Totals"}),(0,v.jsx)("th",{}),(0,v.jsx)("th",{}),this.props.from_customer?null:(0,v.jsx)("th",{}),this.props.from_customer?null:(0,v.jsx)("th",{}),(0,v.jsx)("th",{}),(0,v.jsx)("th",{}),(0,v.jsx)("th",{}),(0,v.jsxs)("th",{children:["Kshs. ",this.numberWithCommas(d[1])]}),(0,v.jsx)("th",{}),(0,v.jsxs)("th",{children:["Kshs. ",this.numberWithCommas(d[0])]}),(0,v.jsx)("th",{})]})]})]}),(0,v.jsx)("div",{children:(0,v.jsx)(u.Z,{size:"sm",children:t})})]})})}}]),s}(d.Component);y.getDerivedStateFromProps=function(e,t){return t.success=!0,t};var g={GET_SALES_LIST_ACTION:f.dK};t.Z=(0,x.$j)((function(e){var t={start_date:new Date(2022,1,20),end_date:new Date(2022,1,28)};return{sales_date:e.update_reducer.sales_date?e.update_reducer.sales_date:t,depots:e.list_reducer.depot_list,products:e.list_reducer.product_list}}),g)(y)},4475:function(e,t,s){s.d(t,{Z:function(){return C}});var n=s(5671),r=s(3144),a=s(136),l=s(5716),i=s(2791),o=s(7022),c=s(3360),d=s(6168),u=s(6856),h=s(3504),p=s(6871),_=s(5861),m=s(7757),x=s.n(m),f=s(717),j=s(4650),v=s(184),y=function(e){(0,a.Z)(s,e);var t=(0,l.Z)(s);function s(){var e;(0,n.Z)(this,s);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(e=t.call.apply(t,[this].concat(a))).state={currency_type:e.props.currency_type},e.handleCurrencyTypeChange=function(){var t=(0,_.Z)(x().mark((function t(s){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.UPDATE_CURRENCY_TYPE_ACTION(s);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return(0,r.Z)(s,[{key:"render",value:function(){var e=this;return(0,v.jsxs)("div",{className:"header",children:[(0,v.jsx)("h5",{children:this.props.header_title}),(0,v.jsxs)("div",{className:"header__left",children:[(0,v.jsx)(f.Z.Group,{className:"header__currency",controlId:"exampleForm.ControlInput1",children:(0,v.jsxs)(f.Z.Select,{"aria-label":"Default select example",size:"sm",onChange:function(t){return e.handleCurrencyTypeChange(t.target.value)},children:[(0,v.jsx)("option",{children:this.state.currency_type}),["Million","Thousand"].map((function(t,s){return e.state.currency_type===t?null:(0,v.jsx)("option",{value:t,children:t},s)}))]})}),(0,v.jsxs)(c.Z,{variant:"secondary",size:"sm",children:[this.props.first_name[0],this.props.last_name[0]]}),(0,v.jsxs)("p",{className:"header__header-name",children:[this.props.first_name," ",this.props.last_name]})]})]})}}]),s}(i.Component);y.getDerivedStateFromProps=function(){var e=(0,_.Z)(x().mark((function e(t,s){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.currency_type=t.currency_type,e.abrupt("return",s);case 2:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}();var g={UPDATE_CURRENCY_TYPE_ACTION:j.wS},b=(0,d.$j)((function(e){return{currency_type:e.update_reducer.currency_type}}),g)(y),N=s(7883),Z=function(e){(0,a.Z)(s,e);var t=(0,l.Z)(s);function s(){var e;(0,n.Z)(this,s);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(e=t.call.apply(t,[this].concat(a))).state={redirect:!1},e.handleLogOut=function(){e.props.USER_LOGGED_OUT_ACTION(),e.setState({redirect:!0})},e}return(0,r.Z)(s,[{key:"render",value:function(){return this.state.redirect?(0,v.jsx)(p.Fg,{to:"/login"}):(0,v.jsxs)(o.Z,{fluid:!0,className:"layout_main",children:[(0,v.jsxs)("div",{className:"layout_main__side",children:[(0,v.jsx)(h.rU,{to:"/",className:"layout_main__logo",children:(0,v.jsx)("img",{src:"".concat(N.J,"/static/opl_logo.png"),alt:"logo",className:"layout_main__logo--img"})}),(0,v.jsxs)("div",{className:"layout_main__links",children:[!0===this.props.token.is_staff?(0,v.jsx)(h.OL,{to:"/",className:"layout_main__button",children:(0,v.jsxs)("h6",{children:[(0,v.jsx)("span",{className:"layout_main__links--span",children:(0,v.jsx)(u.bUq,{size:20,color:"#D04D30"})}),"Dashboard"]})}):null,(0,v.jsx)(h.OL,{to:"/depots",className:"layout_main__button",children:(0,v.jsxs)("h6",{children:[(0,v.jsx)("span",{className:"layout_main__links--span",children:(0,v.jsx)(u.UDA,{})}),"Depots"]})}),!0===this.props.token.is_staff?(0,v.jsx)(h.OL,{to:"/sales",className:"layout_main__button",children:(0,v.jsxs)("h6",{children:[(0,v.jsx)("span",{className:"layout_main__links--span",children:(0,v.jsx)(u.jvR,{})}),"Sales"]})}):null,!0===this.props.token.is_staff?(0,v.jsx)(h.OL,{to:"/customers",className:"layout_main__button",children:(0,v.jsxs)("h6",{children:[(0,v.jsx)("span",{className:"layout_main__links--span",children:(0,v.jsx)(u.J8I,{})}),"Customers"]})}):null,(0,v.jsx)(c.Z,{variant:"transparent",className:"layout_main__button layout_main__logout",onClick:this.handleLogOut,children:(0,v.jsxs)("h6",{children:[(0,v.jsx)("span",{className:"layout_main__links--span",children:(0,v.jsx)(u.lE7,{})}),"Log Out"]})})]})]}),(0,v.jsxs)("div",{className:"layout_main__component",children:[(0,v.jsx)(b,{header_title:this.props.header_title,first_name:this.props.token.data.first_name,last_name:this.props.token.data.last_name}),this.props.children]})]})}}]),s}(i.Component),D={USER_LOGGED_OUT_ACTION:j.$},C=(0,d.$j)((function(e){return{token:e.auth_reducer.token}}),D)(Z)},8116:function(e,t,s){s.d(t,{Z:function(){return N}});var n=s(1413),r=s(5987),a=s(1694),l=s.n(a),i=s(2791),o=s(162),c=s(1784),d=s(184),u=["active","disabled","className","style","activeLabel","children"],h=["children"],p=i.forwardRef((function(e,t){var s=e.active,a=e.disabled,i=e.className,o=e.style,h=e.activeLabel,p=e.children,_=(0,r.Z)(e,u),m=s||a?"span":c.Z;return(0,d.jsx)("li",{ref:t,style:o,className:l()(i,"page-item",{active:s,disabled:a}),children:(0,d.jsxs)(m,(0,n.Z)((0,n.Z)({className:"page-link",disabled:a},_),{},{children:[p,s&&h&&(0,d.jsx)("span",{className:"visually-hidden",children:h})]}))})}));p.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},p.displayName="PageItem";var _=p;function m(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,a=i.forwardRef((function(e,a){var l=e.children,i=(0,r.Z)(e,h);return(0,d.jsxs)(p,(0,n.Z)((0,n.Z)({},i),{},{ref:a,children:[(0,d.jsx)("span",{"aria-hidden":"true",children:l||t}),(0,d.jsx)("span",{className:"visually-hidden",children:s})]}))}));return a.displayName=e,a}var x=m("First","\xab"),f=m("Prev","\u2039","Previous"),j=m("Ellipsis","\u2026","More"),v=m("Next","\u203a"),y=m("Last","\xbb"),g=["bsPrefix","className","size"],b=i.forwardRef((function(e,t){var s=e.bsPrefix,a=e.className,i=e.size,c=(0,r.Z)(e,g),u=(0,o.vE)(s,"pagination");return(0,d.jsx)("ul",(0,n.Z)((0,n.Z)({ref:t},c),{},{className:l()(a,u,i&&"".concat(u,"-").concat(i))}))}));b.displayName="Pagination";var N=Object.assign(b,{First:x,Prev:f,Ellipsis:j,Item:_,Next:v,Last:y})},2591:function(e,t,s){var n=s(1413),r=s(5987),a=s(1694),l=s.n(a),i=s(2791),o=s(162),c=s(184),d=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=i.forwardRef((function(e,t){var s=e.bsPrefix,a=e.className,i=e.striped,u=e.bordered,h=e.borderless,p=e.hover,_=e.size,m=e.variant,x=e.responsive,f=(0,r.Z)(e,d),j=(0,o.vE)(s,"table"),v=l()(a,j,m&&"".concat(j,"-").concat(m),_&&"".concat(j,"-").concat(_),i&&"".concat(j,"-striped"),u&&"".concat(j,"-bordered"),h&&"".concat(j,"-borderless"),p&&"".concat(j,"-hover")),y=(0,c.jsx)("table",(0,n.Z)((0,n.Z)({},f),{},{className:v,ref:t}));if(x){var g="".concat(j,"-responsive");return"string"===typeof x&&(g="".concat(g,"-").concat(x)),(0,c.jsx)("div",{className:g,children:y})}return y}));t.Z=u}}]);
//# sourceMappingURL=463.0a2f5da5.chunk.js.map